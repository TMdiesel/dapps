# Account Abstraction (AA) 基礎知識

## Account Abstractionとは

Account Abstraction（アカウント抽象化）は、Ethereumのアカウントモデルを抽象化し、より柔軟で使いやすいユーザー体験を提供する仕組み。ERC-4337標準で定義されている。

## 従来の課題（EOA）
- **Externally Owned Account (EOA)** の制限
  - 秘密鍵の管理が必要
  - ガス代の事前準備が必要
  - 固定的な署名方式
  - 復旧オプションの不足
  - バッチ処理の困難さ

## AAが解決する問題
1. **鍵管理の改善**: マルチシグ、ソーシャルリカバリー
2. **ガス代の柔軟性**: paymaster による代理支払い
3. **認証の多様化**: 生体認証、MFA対応
4. **UX向上**: メタトランザクション、バッチ処理

## ERC-4337の主要コンポーネント

### 1. UserOperation (UserOp)
- ユーザーが実行したい操作を記述する構造体
- トランザクションの代わりにUserOperationを使用
- ガス計算、署名、実行データを含む

### 2. Smart Contract Wallet
- ユーザーのアカウントとして機能するスマートコントラクト
- カスタムロジックを実装可能（マルチシグ、時間ロック等）

### 3. Entry Point Contract
- 唯一のオンチェーンエントリーポイント
- UserOperationの検証と実行を担当
- ガスの計算と料金回収

### 4. Bundler
- UserOperationを収集し、バンドルしてオンチェーンに送信
- MEVの機会として動作
- オフチェーンでの事前検証を実行

### 5. Paymaster
- ユーザーの代わりにガス代を支払うオプショナルなコントラクト
- スポンサー型、トークン型など多様な支払いモデル

### 6. Factory Contract  
- 新しいスマートコントラクトウォレットを展開
- CREATE2を使用して決定論的アドレス生成

## 学習目標

このプロジェクトで実装・理解したい要素：

1. **基本のAAウォレット**: シンプルなスマートコントラクトウォレット
2. **Bundler**: UserOperationの処理と送信
3. **Paymaster**: ガス代代理支払いの仕組み
4. **Factory**: ウォレットのデプロイ機構
5. **フロントエンド**: AAウォレットを操作するUI
6. **eth-infinitism統合**: 既存のAAインフラの活用

## 技術的な実装アプローチ
- **ローカル開発**: Hardhat + ローカルノード
- **テスト環境**: eth-infinitismのbundlerを使用
- **フロントエンド**: React + Web3ライブラリ
- **言語**: TypeScript中心